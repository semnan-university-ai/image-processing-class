# image-processing-class
image processing class - 992

## Information
* ##### Teacher: Dr. Farzin Yaghmaee - [Contact](mailto:f_yaghmaee@semnan.ac.ir)
* ##### TA : Amir Shokri - [Contact](mailto:amirshokri@semnan.ac.ir)

### Student Info :
* Full name : Alireza Chaji
* github id : alirezachaji
* Email : alirezachaji@protonmail.com
* Type : Shabaneh
***
***

<div dir="rtl">
 
#### تمرین نهایی
#### برنامه تمرین شماره ۱۹ که توسط جناب آقای شکری حل گردیده است را بهبود داده آن را در تابع های مختلف تقسیم بندی کنید و در نهایت ۱۵۰ تصویر با برنامه بهبود داده شده تهیه کرده و میزان تشخیص برنامه OCR متلب را روی این تصاویر بررسی کنید.
. <br />
***
### توضیحات کلی برنامه:
در این برنامه جدای از مبحث تقسیم بندی برنامه به قسمت های مختلف سعی شده است تصاویر تولیدی به گونه ای باشند که تشخیص برای برنامه OCR متلب سخت باشد برای اینکار تصاویر کاراکترها به مقدار زاویه ای رندم دوران داده شده همچنین نویز فلفل نمکی نیز روی این تصاویر اعمال شده است و قسمتی از تصاویر به صورت نگاتیو در آورده شده و همچنین از کیفیت کارکترهای ورودی نیز کاسته شده است
برای تولید ۱۵۰ تصویر از حلقه تکرار ۱۵۰ تایی استفاده شده در هر حلقه کلیه عملیات فوق روی هر تصویر اعمال شده و از کاربر نیز درخواست میکند حدس خود از کارکترهای هر تصویر را که مشاهده می کند تایپ کند و در نهایت برنامه اطلاعات این ۱۵۰ تصویر را در آرایه ای ذخیره کرده و به فایل اکسل منتقل می کند مشاهده می گردد که در ۱۵۰ تصویر تولید شده دقت تشخیص برای متلب برابر صفر درصد و برای اینجانب ۸۷ درصد بوده است. همچنین در این برنامه برای ۱۵۰ کپچای تولیدی ابعاد تصویر و تعداد کاراکتر تصویر نیز به صورت رندم  در نظر گرفته شده است در بخش های بعد به توضیح جزئیات برنامه می پردازیم..
 
### توضیحات بخش های برنامه
***

 این قسمت باعث بسته شدن تمام پنجره ها ، ریست شدن تمام متغیر ها و پاک شدن کامند ویندو می گردد <br />
</div>

``` matlab

close all;         
clear all;         
clc;    

```
***
<div dir="rtl">

در این بخش ابتدا آرایه جهت ذخیره اطلاعات ۱۵۰ تصویر تولیدی و همچین متغیرهایی جهت معیار تشخیص درست کاربر و تابع OCR متلب تعریف گردیده است .

</div>

``` matlab
g=cell(150,7);
correct_ocr=0;
correct_guess=0;
g(1,:)={'Item','Captcha','Image','OCR','Correctness_OCR','Guess','Correctness_guess'};
 
```

***
<div dir="rtl">

در این بخش از برنامه قسمتی از حلقه تکرار ۱۵۰ تایی آورده شده است ابتدا تعداد کاراکتر ها به صورتی عددی رندم بین ۳ تا ۶ مشخص گردیده است سپس ابعاد تصویر نیر به صورت رندم تعریف می گردند. در ادامه برنامه توسط تابع main_func تصویر کپچا تولید شده و به همراه تکست کاراکترهای کپچا به برنامه اصلی باز گردانده می شود و در ادامه اطلاعات آن تصویر از جمله شماره - کد کپچا - ماتریس تصویر - خروجی تابع OCR متلب از این تصویر در آرایه ذخیره می گردد و سپس توسط دستورات شرطی درستی تشخیص تابع OCR متلب بررسی و نتیجه در آرایه ذخیره می گردد .

</div>

``` matlab
for i=1:150
    n=randi([3,6]);
    height=randi([100,400]);
    width=randi([400,n*150]);
    [pic,code]=main_func(n,height,width);
    g(i+1,1)={i};
    g(i+1,2)={code};
    g(i+1,3)={pic};
    d=ocr(pic);
    ocr_out=d.Text;
    g(i+1,4)={ocr_out};
    sc=size(code);
    so=size(ocr_out);
    if (sc(2)==so(2))
        if(ocr_out==char(code))
            correct_ocr=correct_ocr+1;
            g(i+1,5)={1};
        else
            g(i+1,5)={0};
        end  
    else
        g(i+1,5)={0};
    end
 
```

***
<div dir="rtl">

در این بخش از برنامه ادامه بخش های حلقه تکرار آورده شده است که در آن ابتدا از کاربر درخواست می کند حدس خود از تصویر کپچایی که توسط تابع main_func ایجاد شده را تایپ کند و این حدس را در ارایه ذخیره می کند سپس درستی حدس کاربر توسط دستورات شرطی با کارکترهای اصلی مقایسه گردیده و نتیجه تشخیص در آرایه ذخیره می گردد در انتهای حلقه تکرار نیز تصویر کپچای تولیدی با نام شماره تصویر در مسیر جاری با فرمت PNG ذخیره می گردد. در قسمت پایانی برنامه نیز کل اطلاعات موجود در ارایه در فایل اکسل به نام Result.xlsx ذخیره می گردد
</div>

``` matlab
    a=input("Enter The Captcha Letters no "+num2str(i)+": ",'s');
    g(i+1,6)={a};
    so=size(a);
    if (sc(2)==so(2))
        if(a==char(code))
            correct_guess=correct_guess+1;
            g(i+1,7)={1};
        else
            g(i+1,7)={0};
        end  
    else
        g(i+1,5)={0};
    end
    imwrite(pic,num2str(i)+".png");
end 
xlswrite('Result.xlsx',g);
```
***
#### توضیحات توابع استفاده شده در برنامه
***
<div dir="rtl">

این تابع مربوط به محاسبه هیستوگرام می باشد عملکرد آن به این صورت است که یک کانال رنگی را از ورودی گرفته و توسط حلقه های تکرار فراوانی مقادیر پیکسل های هم مقدار را با هم جمع شده و در نهایت هیستوگرام تصویر را تولید کرده و آن را به برنامه اصلی برمی گرداند .

</div>

``` matlab

-------
***
<div dir="rtl">

این تابع مربوط به محاسبه هیستوگرام می باشد عملکرد آن به این صورت است که یک کانال رنگی را از ورودی گرفته و توسط حلقه های تکرار فراوانی مقادیر پیکسل های هم مقدار را با هم جمع شده و در نهایت هیستوگرام تصویر را تولید کرده و آن را به برنامه اصلی برمی گرداند .

</div>

``` matlab
  
function his=ch_hist(pic)
n=size(pic);
his=zeros(1,255);
x=[1:255];
for k=1:255
    s=0;
    for i=1:n(1)
        for j=1:n(2)
            if(pic(i,j)==k)
                s=s+1;
            end    
        end
    end
    his(k)=s;
end  
```
***
![alt text](https://github.com/semnan-university-ai/image-processing-class/blob/adeace4ac5778db155e9302290f15a54b2533e3f/excersiecs/alirezachaji/23/Exce23.png)
***

