w=load_database();
W بارگذارى ديتابيس تصاوير در ماتريس
در اينجا يك عكس به صورت تصادفى از ديتابيس انتخاب مى شود و مابقى عكس ها براى آموزش به برنامه مورد استفاده قرار مى گيرند. سپس از عكس تصادفى براى تشخيص آن با عكس هاى آموزش داده شده استفاده مى شود.
ri=round(400*rand(1,1));  
        
انتخاب يك عكس از بين عكس های موجود 
r=w(:,ri);
متغيرى است كه عكسى را كه قرار است بعدا روى آن تست شود باشدr

v=w(:,[1:ri-1 ri+1:end]);           
متغيرى است كه شامل مابقی عکسهادر ديتابيس استv

N=20;
تعداد شناساگرها براى هر عكس 

O=uint8(ones(1,size(v,2))); 
كسر شباهات از متغير v



m=uint8(mean(v,2));
متغيرى است كه شامل عكس است (بدين صورت كه عكسى كه به صورت تصادفى انتخاب شده است m تاى ديگر)
vzm=v-uint8(single(m)*single(O));   
ميزان حذف شده ها از آن دسته از عكسهايى است كه شباهت ندارند به عكس تستvzm
L=single(vzm)'*single(vzm);
[V,D]=eig(L);
V=single(vzm)*V;
در خطوط بالا وابستگى بين تصاوير‌ مى باشد كه با عكسهاى درون ديتابيس شروع به گشتن كرده و در خط پايين (ادامه در پايين)
V=V(:,end:-1:end-(N-1));            
تعداد شناساگر ها كه بودند را پيدا كرده و 10 شباهت را در اولويت قرار خواهد دادn.

cv=zeros(size(v,2),N);
(محاسبه تعداد شناساگرها) N
fori=1:size(v,2);
cv(i,:)=single(vzm(:,i))'*V;
end
در خطوط پايين و حلقه حد ميانه تشخيص داده شده يك عكس از بين 10 شباهت به عكس هاى مجاور آن انتخاب و نمايش داده مى شود.

subplot(122);
p=r-m;                              
تفریق تصویر با توجه به میانه آن 
s=single(p)'*V;
z=[];
fori=1:size(v,2)
    z=[z,norm(cv(i,:)-s,2)];
if(rem(i,20)==0),imshow(reshape(v(:,i),112,92)),end;
drawnow;	
رسم يا نمايش عكس تشخيص داده شده
end

[a,i]=min(z);
subplot(122);
imshow(reshape(v(:,i),112,92));title('Found!','FontWeight','bold','Fontsize',16,'color','red');
نمايش برچسب براى تشخيص
